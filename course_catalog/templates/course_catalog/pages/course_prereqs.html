{% extends "course_catalog/pages/base_qcumber.html" %}

{% load shell_snippets %}
{% load compress %}

{% block page_title %} Qcumber | {{ course.subject.abbreviation }} {{ course.number }} - {{ course.title }} {% endblock %}

{% block main_container %}
    <!-- Breadcrumbs -->
    <ul class="breadcrumb">
      <li><a href="{% url 'home' %}">Home</a> <span class="divider">-</span></li>
      <li><a href="{{ course.subject.get_absolute_url }}">{{ course.subject.title }}</a> <span class="divider">-</span></li>
      <li><a href="{{ course.get_absolute_url }}">{{ course.subject.abbreviation }} {{ course.number }}</a> <span class="divider">-</span></li>
      <li class="active">Prerequisite Chart</li>
    </ul>

    <!-- Graph Display -->
    <div class="graph-container">
        <noscript>Unfortunately, the prerequisite chart display requires Javascript to function correctly.  Please enable Javascript to see the prerequisite chart.</noscript>

        <!-- Define the arrowhead -->
        <svg id="graph" width="0" height="0">
            <defs>
                <marker id="arrowhead"
                        viewBox="0 0 10 10"
                        refX="8"
                        refY="5"
                        markerUnits="strokeWidth"
                        markerWidth="8"
                        markerHeight="5"
                        orient="auto"
                        style="fill: #333">
                    <path d="M 0 0 L 10 5 L 0 10 z"></path>
                </marker>
            </defs>
        </svg>
    </div>

    <!-- Graph Information -->
    <div class="row">
        <div class="alert alert-warning span6">
            This graph was generated automatically and has not been checked for accuracy.  Be sure to check the textual version of the prerequisites.
        </div>


        <div class="graph-legend">
            <h3 style="margin-bottom: 0px;">Legend</h3>

            <svg width="400px" height="75px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <defs>
                    <marker id="arrowhead"
                            viewBox="0 0 10 10"
                            refX="8"
                            refY="5"
                            markerUnits="strokeWidth"
                            markerWidth="8"
                            markerHeight="5"
                            orient="auto"
                            style="fill: #333">
                        <path d="M 0 0 L 10 5 L 0 10 z"></path>
                    </marker>
                </defs>
                <g>
                    <path class="edge prerequisite" marker-end="url(#arrowhead)" d="M10,25L130,25"></path>
                    <path class="edge corequisite" marker-end="url(#arrowhead)" d="M140,25L260,25"></path>
                    <path class="edge recommend" marker-end="url(#arrowhead)" d="M270,25L390,25"></path>

                    <text class="legend-label" text-anchor="middle" x="70" y="50">Prerequisite</text>
                    <text class="legend-label" text-anchor="middle" x="200" y="50">Corequisite</text>
                    <text class="legend-label" text-anchor="middle" x="330" y="50">Recommended</text>
                </g>
            </svg>
        </div>
    </div>

    <!-- Graph Generation -->
    <script>{{ graphdef }}</script>

    {% compress js %}
        <script src="{{ STATIC_URL }}js/d3.v3.min.js"></script>
        <script src="{{ STATIC_URL }}js/dagre.min.js"></script>
        <script src="{{ STATIC_URL }}js/prgraph.js"></script>
    {% endcompress %}
{% endblock %}
